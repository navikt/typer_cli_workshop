# Laste ned nettsider

For 친 minne oss selv p친 hva oppgaven var gjengir vi den her:

::: {.column-margin}
Vi er n친 ferdig med oppvarmingen og kan legge fra oss `hello.py` 游땩
:::

> Vi tar sikte p친 친 bygge opp et enkelt kommandolinje-verkt칮y som tar inn p친
> kommandolinjen nettsider og laster ned sidene.

## Den spede begynnelse

Vi starter med en mal for kommandolinje-verkt칮y og legger f칮lgende i `main.py` i
`cli_workshop` prosjektet v친rt.

```python
import typer
from rich.console import Console

app = typer.Typer()
console = Console()


@app.command()
def main() -> None:
    pass


if __name__ == "__main__":
    app()
```

## Ta inn et argument

F칮r vi begynner 친 laste ned nettsider s친 kan det v칝re greit 친 vite hvilke
nettsider vi skal laste ned. La oss starte med 친 ta inn 칠n nettside og utvide
derfra.

::: {.callout-tip}
## Oppgave
I `main.py` ta inn et argument som er en nettside som brukeren 칮nsker 친 laste
ned. Vi starter enkelt og tar inn bare 칠n nettside og tar den inn som `str`.

Skriv deretter ut nettsiden med `console`.
:::

::: {.callout-note collapse="true"}
## L칮sning
```python
@app.command()
def main(webpage: str) -> None:
    console.print(f"{webpage}")
```
:::

## Ta inn en liste med nettsider

Det holder jo egentlig ikke med bare en nettside, vi m친 ta inn flere! La oss
pr칮ve 친 친pne for at bruker kan gi inn flere nettsider p친 kommandolinjen.

::: {.callout-tip}
## Oppgave
I `main.py` ta inn et argument som er en liste med nettsider som brukeren 칮nsker
친 laste ned.

Skriv deretter ut nettsidene med `console`.
:::

::: {.callout-caution collapse="true"}
## Tips
Vi definerer en liste type i Python sitt typesystem med:

```python
min_liste: list[int] = [1, 2, 3]
```
:::

::: {.callout-note collapse="true"}
## L칮sning
```python
@app.command()
def main(webpages: list[str]) -> None:
    for webpage in webpages:
        console.print(f"{webpage}")
```
:::

## Fremgangsindikator

N친 som vi klarer 친 ta inn en liste med argumenter er det p친 tide 친 gj칮re
verkt칮yet litt mer visuelt. La oss legge til en [fremdriftsindikator med
`rich`](https://rich.readthedocs.io/en/stable/progress.html) og jukse litt for 친
faktisk kunne se den.

Vi legger f칮rst til en fremdriftsindikator for alle nettsidene og deretter
venter litt mellom hver gang vi skriver ut slik at vi kan se hva som skjer.

```python
import time

import typer
from rich.console import Console
from rich.progress import Progress

app = typer.Typer()
console = Console()


@app.command()
def main(webpages: list[str]) -> None:
    with Progress(console=console) as progress: # <1>
        task = progress.add_task("Nettsider lastet ned", total=len(webpages)) # <2>
        for webpage in webpages:
            time.sleep(3) # <3>
            console.print(f"Lastet ned: {webpage}")
            progress.advance(task, advance=1) # <4>


if __name__ == "__main__":
    app()
```
1. Vi oppretter en fremdriftsindikator instans.
2. Vi lager en oppgave 친 vise fremdrift for.
3. Juks for 친 se fremdrift 游봊
4. Vi oppdaterer oppgaven for 친 vise fremdrift.

---

::: {.callout-note}
## Oppgave
Legg til en ny oppgave per nettside og lat som at hver nettside tar 20 runder
med `time.sleep(0.1)` for 친 ferdigstille.

```python
for webpage in webpages:
    for _ in range(20):
        time.sleep(0.1)
        # Oppdater fremdrift her
    console.print(f"Lastet ned: {webpage}")
    progress.advance(task, advance=1)
```
:::

::: {.callout-caution}
## Tips
Pr칮v 친 bruk `progress.remove_task` slik at nedlasting per nettside bare vises
midlertidig.
:::

::: {.callout-note collapse="true"}
## L칮sning
```python
@app.command()
def main(webpages: list[str]) -> None:
    with Progress(console=console) as progress:
        task = progress.add_task("Nettsider lastet ned", total=len(webpages))
        for webpage in webpages:
            page_task = progress.add_task(f"Laster ned [italic magenta]{webpage}[/]", total=20)
            for _ in range(20):
                time.sleep(0.1)
                progress.advance(page_task, advance=1)
            progress.remove_task(page_task)
            progress.advance(task, advance=1)
```
:::

## Laste ned nettsider

La oss n친 legge til funksjonaliteten for 친 laste ned nettsiden som vi f친r inn.
