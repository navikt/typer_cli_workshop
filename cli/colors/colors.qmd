# Fargelegging

Vi skal ta en liten avstikker til f√∏r vi begynner p√• selve oppgaven. Vi skal i
dette kapittelet se litt p√• hvordan vi kan bruke `rich` for √• gj√∏re
kommandolinje-verkt√∏yet v√•rt litt enklere for √∏ynene.

::: {.column-margin}
> Kom arbeidslyst og treng deg p√• -her skal du motstand finne!
>
> - Solan Gundersen
:::

Vi skal ikke bruke alt for lang tid p√• `rich`, da det sikkert er mer interessant
√• finne ut av selv, men vi skal vise litt av fordelen med `rich` over vanlig
`print`.

## Bruke `rich.print`

Den enkleste m√•ten √• bruke `rich` p√• er √• importere `print` fra `rich` og bruke
denne metoden istedenfor den vanlige `print`.

Vi begynner med programmet vi endte opp med etter forrige kapittel:

```python
import typer

app = typer.Typer()


@app.command()
def main(name: str, formal: bool = False) -> None:
    """Si hei til det gitte navnet"""
    if formal:
        print(f"Hallo {name}")
    else:
        print(f"Hei {name}!")


if __name__ == "__main__":
    app()
```

La oss f√∏rst importere `rich` og se om det ble anderledes.

√òverst i verkt√∏yet kan vi endre avhengigheter slik at det blir som f√∏lger:

```python
import typer
from rich import print

app = typer.Typer()
```

Dette gj√∏r at linjene v√•re med `print` endres fra Python sin vanlige metode til
`rich` sin utskrift. Vi kan deretter kj√∏re verkt√∏yet som vanlig.

```bash
uv run hello.py NAV
```

Det gjorde ikke s√• stor forskjell, men la oss raskt se hva vi kan f√• til med
`rich`.

### Skrive ut emoji üò≤

La oss legge til en emoji üé©. I `rich` kan vi bruke [omtrent samme
syntaks som i Slack](https://rich.readthedocs.io/en/stable/markup.html#emoji).
Siden en üé© er litt formel s√• legger vi den til i formell utskrift.

Vi endrer utskriften til f√∏lgende:

```python
@app.command()
def main(name: str, formal: bool = False) -> None:
    """Si hei til det gitte navnet"""
    if formal:
        print(f"Hallo {name} :top_hat:")
    else:
        print(f"Hei {name}!")
```

Husk √• kj√∏re med `--formal`.

### Skrive ut i farger

N√• ble jo `--formal` utskriften veldig fin, men la oss ogs√• gj√∏re noe for mannen
i gata. Vi legger til litt farger og uthevning!

::: {.column-margin}
Det er jo vanlige folks tur...

(Skrevet i 2024)
:::

[`rich` har st√∏tte for mye
forskjellig](https://rich.readthedocs.io/en/stable/markup.html#syntax) s√• her er
det bare √• sl√• seg l√∏s.

Vi endrer igjen funksjonen v√•r:

```python
@app.command()
def main(name: str, formal: bool = False) -> None:
    """Si hei til det gitte navnet"""
    if formal:
        print(f"Hallo {name} :top_hat:")
    else:
        print(f"Hei [bold magenta]{name}[/]!")
```

Det ble superflott!

## Bruke `rich.console.Console`

Selv om det er veldig praktisk √• bare importere `from rich import print` s√• er
det ofte bedre √• opprette en `Console` som `rich` kan bruke. Dette gir litt
flere kapabiliteter, som √• skrive ut tabeller samt √• vise en
fremdriftsindikator.

La oss skrive om verkt√∏yet v√•rt til √• bruke `rich.console.Console` og deretter
leke oss litt med en tabell.

For √• bruke `Console` er det ofte greit √• bare lage en global variabel som vi
kan benytte oss til √• skrive ut med. Vi fortsetter p√• programmet over.

```python
import typer
from rich import print
from rich.console import Console # <1>

app = typer.Typer()
console = Console() # <2>


@app.command()
def main(name: str, formal: bool = False) -> None:
    """Si hei til det gitte navnet"""
    if formal:
        print(f"Hallo {name} :top_hat:")
    else:
        print(f"Hei [bold magenta]{name}[/]!")


if __name__ == "__main__":
    app()
```
1. Vi importerer fra `rich.console`
2. Opprett en global instans

Merk at forel√∏pig har vi ikke begynt √• bruke `console` instansen v√•r. Det gj√∏r
vi ved √• bytte ut `print` med `console.print`.

```python
@app.command()
def main(name: str, formal: bool = False) -> None:
    """Si hei til det gitte navnet"""
    if formal:
        console.print(f"Hallo {name} :top_hat:")
    else:
        console.print(f"Hei [bold magenta]{name}[/]!")
```

::: {.column-margin}
üóíÔ∏è Vi kan n√• ogs√• fjerne linjen med

```python
from rich import print
```
:::

Verkt√∏yet v√•rt burde ikke ha endret oppf√∏rsel, men vi har n√• mulighet til √•
gj√∏re enda mer med `rich`.

### Skrive ut en tabell

La oss bruke den nye kraften til √• skrive ut avansert formatering, [en
tabell](https://rich.readthedocs.io/en/stable/tables.html)!

::: {.callout-tip}
## Oppgave
For at ikke tabellen skal skrives ut hver gang vi kaller p√• verkt√∏yet v√•rt. Legg
til et nytt valg som bestemmer om tabellen skal skrives ut eller ikke.
:::

::: {.callout-note collapse="true"}
## L√∏sningsforslag
```python
@app.command()
def main(name: str, formal: bool = False, summary: bool = False) -> None: # <1>
    """Si hei til det gitte navnet"""
    if formal:
        console.print(f"Hallo {name} :top_hat:")
    else:
        console.print(f"Hei [bold magenta]{name}[/]!")
    if summary: # <2>
        pass
```
1. Legg til et nytt valgfritt `bool` parameter p√• metoden v√•r (`summary: bool = False`).
2. Skriv ut tabellen bare n√•r `summary` er sann.
:::

For √• ikke bruke for mye tid p√• √• lage en tabell l√•ner vi en allerede eksisterende.

```python
import typer
from rich.console import Console
from rich.table import Table

app = typer.Typer()
console = Console()


def create_table() -> Table:
    """Hjelpemetode for √• generere en tabell i `rich`"""
    table = Table(title="Star Wars Movies")

    table.add_column("Released", justify="right", style="cyan", no_wrap=True)
    table.add_column("Title", style="magenta")
    table.add_column("Box Office", justify="right", style="green")

    table.add_row("Dec 20, 2019", "Star Wars: The Rise of Skywalker", "$952,110,690")
    table.add_row("May 25, 2018", "Solo: A Star Wars Story", "$393,151,347")
    table.add_row("Dec 15, 2017", "Star Wars Ep. V111: The Last Jedi", "$1,332,539,889")
    table.add_row("Dec 16, 2016", "Rogue One: A Star Wars Story", "$1,332,439,889")

    return table


@app.command()
def main(name: str, formal: bool = False) -> None:
    """Si hei til det gitte navnet"""
    if formal:
        console.print(f"Hallo {name} :top_hat:")
    else:
        console.print(f"Hei [bold magenta]{name}[/]!")
    console.print(create_table())


if __name__ == "__main__":
    app()
```

Som man forh√•pentligvis ser s√• gir `rich` veldig gode muligheter for √• gj√∏re
programmene, og kommandolinje-verkt√∏y, mye mer interaktive og enkle √• forst√•.
